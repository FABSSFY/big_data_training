{"paragraphs":[{"title":"1. Download Data","text":"%sh\n# https://raw.githubusercontent.com/datafibers/big_data_training/master/data/customer_details.csv\n# https://raw.githubusercontent.com/datafibers/big_data_training/master/data/transaction_details.csv\n# https://raw.githubusercontent.com/datafibers/big_data_training/master/data/store_details.csv\n# https://raw.githubusercontent.com/datafibers/big_data_training/master/data/store_review.csv","dateUpdated":"2018-04-08T20:33:44+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":4,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":233.646,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368311_-1455042974","id":"20180401-161259_699755136","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:54107"},{"title":"2. Understand the Data","text":"%sh\n## /tmp/data/\n\n","dateUpdated":"2018-04-08T20:33:53+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":4,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":95.087,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368311_-1455042974","id":"20180401-161505_961136869","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54108"},{"title":"3. Upload the file to HDFS","text":"%sh\n##/tmp/shopping/data/customer/\n##/tmp/shopping/data/transaction/\n##/tmp/shopping/data/store/\n##/tmp/shopping/data/review/","dateUpdated":"2018-04-08T20:34:30+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":4,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":179.028,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368311_-1455042974","id":"20180401-171256_839724140","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54109"},{"text":"%md\n### 4. Create External Tables for All Source Files","dateUpdated":"2018-04-08T20:29:28+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368311_-1455042974","id":"20180401-191753_1377532812","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54110"},{"title":"4.1 Clear all tables if exists","text":"%sh\n#beeline -e \"drop database if exists shopping cascade; create database shopping;\"","dateUpdated":"2018-04-08T20:34:37+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368311_-1455042974","id":"20180401-192123_1635518458","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54111"},{"text":"%spark.sql\nuse shopping","dateUpdated":"2018-04-08T20:29:28+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368312_-1456966719","id":"20180407-030105_676919169","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54112"},{"title":"","text":"%spark.sql\n--create external table if not exists ext_customer_details","dateUpdated":"2018-04-08T20:35:24+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","editorHide":false,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368312_-1456966719","id":"20180401-191112_214328140","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54113"},{"text":"%spark.sql\n--create external table if not exists ext_transaction_details","dateUpdated":"2018-04-08T20:35:36+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/sql","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368312_-1456966719","id":"20180401-193625_237647051","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54114"},{"text":"%spark.sql\n--create external table if not exists ext_store_details","dateUpdated":"2018-04-08T20:35:43+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/sql","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368312_-1456966719","id":"20180401-193840_2108660994","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54115"},{"text":"%spark.sql\n--create external table if not exists ext_store_review","dateUpdated":"2018-04-08T20:35:56+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/sql","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368312_-1456966719","id":"20180401-193943_966938515","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54116"},{"title":"4.2 Verify all Tables are Created","text":"%spark.sql\nselect * from ext_customer_details limit 20\n--select * from ext_transaction_details limit 20\n--select * from ext_store_details limit 20\n--select * from ext_store_review limit 20","dateUpdated":"2018-04-08T20:29:28+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368312_-1456966719","id":"20180401-192732_1073293421","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54117"},{"text":"%md\n### 5. Data Cleaning","dateUpdated":"2018-04-08T20:29:28+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368312_-1456966719","id":"20180401-200024_100120368","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54118"},{"title":"5.1 Clean and Mask customer_details","text":"","dateUpdated":"2018-04-08T20:34:54+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368312_-1456966719","id":"20180401-200134_429510392","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54119"},{"title":"5.2 Clean transaction_details into partition table","text":"%spark.sql\n--create table if not exists transaction_details","dateUpdated":"2018-04-08T20:36:13+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368313_-1457351468","id":"20180401-203736_975091874","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54120"},{"text":"%spark.sql\n--there are duplicated transaction_id in ext_transaction_details\n--select transaction_id, count(*) from ext_transaction_details group by transaction_id having count(*) > 1\n--select * from ext_transaction_details where transaction_id  = '8028'","dateUpdated":"2018-04-08T20:36:25+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368313_-1457351468","id":"20180401-223812_1843447760","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54121"},{"text":"%spark.sql\nset hive.exec.dynamic.partition.mode=nonstrict","dateUpdated":"2018-04-08T20:29:28+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368313_-1457351468","id":"20180401-205004_1620555887","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54122"},{"text":"%spark.sql\n--insert overwrite table transaction_details partition(purchase_month)","dateUpdated":"2018-04-08T20:36:36+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368313_-1457351468","id":"20180401-201752_897618689","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54123"},{"text":"%spark.sql\n--select * from transaction_details where transaction_id like '%fix%'\n--show partitions transaction_details","dateUpdated":"2018-04-08T20:36:39+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368313_-1457351468","id":"20180401-203629_926838982","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54124"},{"title":"5.3 Clean store_review table","text":"%spark.sql\n--select count(*) from ext_store_review r join transaction_details t on r.transaction_id = t.transaction_id and r.store_id = t.store_id where review_score <> '' --153 row\n--select count(*) from ext_store_review where review_score <> '' --937 rows, since so many rows are wrong with store_id, we'll ignore store_id in this\n--create view if not exists vw_store_review","dateUpdated":"2018-04-08T20:36:51+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368318_-1457736217","id":"20180401-205201_1431879397","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54125"},{"text":"%spark.sql\nshow tables","dateUpdated":"2018-04-08T20:29:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368318_-1457736217","id":"20180401-215837_426310381","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54126"},{"text":"%md\n### 6. Data Analysis - Customer Centric","dateUpdated":"2018-04-08T20:29:28+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368318_-1457736217","id":"20180401-222543_1130939389","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54127"},{"title":"6.1 Find out most popular card being used by customer","text":"","dateUpdated":"2018-04-08T20:36:54+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"pieChart","height":279.028,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false},"pieChart":{}},"commonSetting":{},"keys":[{"name":"credit_type","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"spending_avg","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368319_-1458120966","id":"20180401-223653_1285592903","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54128"},{"title":"6.2 Find out the top 5 job titles in the customer data","text":"","dateUpdated":"2018-04-08T20:37:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"job","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"pn","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368319_-1458120966","id":"20180401-230612_1722838235","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54129"},{"title":"6.3 For female in US, what's the most popular card they are holding","text":"","dateUpdated":"2018-04-08T20:36:56+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368319_-1458120966","id":"20180401-231645_683399052","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54130"},{"title":"6.4 Calculate customer statistic by gender and country","text":"","dateUpdated":"2018-04-08T20:37:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":321.094,"optionOpen":false,"setting":{"multiBarChart":{"stacked":true}},"commonSetting":{},"keys":[{"name":"country","index":1,"aggr":"sum"}],"groups":[{"name":"gender","index":2,"aggr":"sum"}],"values":[{"name":"_c0","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368319_-1458120966","id":"20180401-232307_145793329","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54131"},{"text":"%md\n### 7. Data Analysis - Transaction Centric","dateUpdated":"2018-04-08T20:29:28+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368319_-1458120966","id":"20180401-235548_2008115798","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54132"},{"title":"7.1 Calculate total revenue by month","text":"","dateUpdated":"2018-04-08T20:36:58+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":358.056,"optionOpen":false,"setting":{"lineChart":{}},"commonSetting":{},"keys":[{"name":"purchase_month","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"revenue_mom","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368319_-1458120966","id":"20180401-232857_2009295861","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54133"},{"title":"7.2 Calculate total revenue by each quarter","text":"","dateUpdated":"2018-04-08T20:37:05+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":179.028,"optionOpen":false,"setting":{"lineChart":{},"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"year_quarter","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"revenue_qoq","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368319_-1458120966","id":"20180401-235444_529414615","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54134"},{"title":"7.3 Calculate total revenue by year","text":"","dateUpdated":"2018-04-08T20:37:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"year","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"revenue_mom","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368319_-1458120966","id":"20180404-023337_2097675496","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54135"},{"title":"7.4 Calculate total revenue by week day","text":"","dateUpdated":"2018-04-08T20:37:07+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"weekday","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"revenue_wow","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368319_-1458120966","id":"20180405-003659_1365686338","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54136"},{"title":"7.1 - 7.4 Do them Together","text":"","dateUpdated":"2018-04-08T20:37:12+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"weekday","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"total","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368319_-1458120966","id":"20180405-020946_1119840139","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54137"},{"title":"7.5/7.6 Calculate total revenue/average purchase by time bucket (morning, noon, etc.)","text":"%spark.sql\n--define time bucket \n--early morning: (5:00, 8:00]\n--morning: (8:00, 11:00]\n--noon: (11:00, 13:00]\n--afternoon: (13:00, 18:00]\n--evening: (18:00, 22:00]\n--night: (22:00, 5:00] --make it as else, since it is not liner increasing\n--We also format the time. 1st format time to 19:23 like, then compare, then convert minites to hours","dateUpdated":"2018-04-08T20:37:20+0000","config":{"lineNumbers":true,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"pieChart":{},"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"time_bucket","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_spend","index":1,"aggr":"sum"},{"name":"revenue_k","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368323_-1373476208","id":"20180405-011124_1774329615","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54138"},{"title":"7.7 Calculate average spending by week day","text":"","dateUpdated":"2018-04-08T20:37:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"weekday","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_price","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368323_-1373476208","id":"20180405-012616_1668212696","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54139"},{"title":"7.8 Calculate total number of transactions for year, quarter, month","text":"","dateUpdated":"2018-04-08T20:37:24+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"purchase_month","index":2,"aggr":"sum"}],"groups":[{"name":"year_quarter","index":3,"aggr":"sum"}],"values":[{"name":"total","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368323_-1373476208","id":"20180407-154819_1975565456","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54140"},{"title":"7.9 What’s the top 10 customer who has the most transaction?","text":"]","dateUpdated":"2018-04-08T20:37:27+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368323_-1373476208","id":"20180407-155221_384462996","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54141"},{"title":"7.10 What’s the top 10 customer who has the most spendings?","text":"","dateUpdated":"2018-04-08T20:37:26+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368329_-1377323697","id":"20180407-160920_795012615","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54142"},{"text":"%md\n### 7. Data Analysis - Transaction Centric II","dateUpdated":"2018-04-08T20:29:28+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368330_-1376169450","id":"20180407-163426_245303619","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54143"},{"title":"7.11 Who has the min. number of transactions during the period?","text":"","dateUpdated":"2018-04-08T20:37:34+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368330_-1376169450","id":"20180407-163735_1964545204","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54144"},{"title":"7.12 - 7.13 Calculate total unique customers by each quarter and year","text":"","dateUpdated":"2018-04-08T20:37:32+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"year_quarter","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"total","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368331_-1376554199","id":"20180407-170516_1001461004","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54145"},{"title":"7.14 Calculate max of average of customer for all the campaign","text":"","dateUpdated":"2018-04-08T20:37:36+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":93.0556,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368331_-1376554199","id":"20180407-171102_1440348049","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54146"},{"title":"7.15 - 7.16 Who spend/purchase most for each month?","text":"","dateUpdated":"2018-04-08T20:37:38+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false},"stackedAreaChart":{"style":"stack"},"lineChart":{"lineWithFocus":false,"forceY":true}},"commonSetting":{},"keys":[{"name":"purchase_month","index":0,"aggr":"sum"}],"groups":[{"name":"measure_name","index":1,"aggr":"sum"}],"values":[{"name":"measure_value","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368331_-1376554199","id":"20180407-191318_552385904","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54147"},{"title":"7.17 Find top 5 popular sold product by total spending","text":"]","dateUpdated":"2018-04-08T20:37:40+0000","config":{"editorSetting":{"language":"scala"},"colWidth":4,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":199.028,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368331_-1376554199","id":"20180407-195042_1423142888","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54148"},{"title":"7.18 Find top 5 popular sold product by frequency of purchase","text":"","dateUpdated":"2018-04-08T20:37:46+0000","config":{"editorSetting":{"language":"scala"},"colWidth":4,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":201.094,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368331_-1376554199","id":"20180407-203107_749290301","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54149"},{"title":"7.19 Find top 5 popular sold product by number of customer","text":"","dateUpdated":"2018-04-08T20:37:44+0000","config":{"editorSetting":{"language":"scala"},"colWidth":4,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":202.083,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368331_-1376554199","id":"20180407-203845_1256466495","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54150"},{"title":"7.20 Verify the data","text":"%spark.sql\nselect * from transaction_details where product in ('Goat - Whole Cut')","dateUpdated":"2018-04-08T20:29:28+0000","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368332_-1378477943","id":"20180407-204455_1947193159","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54151"},{"text":"%md\n### 8. Data Analysis - Store Centric","dateUpdated":"2018-04-08T20:29:28+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368332_-1378477943","id":"20180407-213513_418455697","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54152"},{"title":"8.1 Find out most popular store being visit by unique customer","text":"","dateUpdated":"2018-04-08T20:37:50+0000","config":{"editorSetting":{"language":"scala"},"colWidth":4,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368332_-1378477943","id":"20180407-213511_633147235","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54153"},{"title":"8.2 Find out most popular store by amount purchased by customer","text":"","dateUpdated":"2018-04-08T20:37:48+0000","config":{"editorSetting":{"language":"scala"},"colWidth":4,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":282.083,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368332_-1378477943","id":"20180407-205352_1796053220","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54154"},{"title":"8.3 Find out most popular store by transactions by customer","text":"","dateUpdated":"2018-04-08T20:37:52+0000","config":{"editorSetting":{"language":"scala"},"colWidth":4,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368332_-1378477943","id":"20180408-005758_1590102233","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54155"},{"title":"8.4 Get the most popular product by stores by unique customer","text":"","dateUpdated":"2018-04-08T20:37:57+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368333_-1378862692","id":"20180408-025657_841130109","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54156"},{"title":"8.5 Get the ratio of employee vs. customer visit for each store","text":"","dateUpdated":"2018-04-08T20:37:54+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":369.028,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"store_name","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"cust_per_employee_within_period","index":3,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368333_-1378862692","id":"20180408-142754_287571241","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54157"},{"title":"8.6 Calculate revenue for each store by year and month","text":"","dateUpdated":"2018-04-08T20:37:58+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"purchase_month","index":1,"aggr":"sum"}],"groups":[{"name":"store_name","index":0,"aggr":"sum"}],"values":[{"name":"revenue","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368333_-1378862692","id":"20180408-142006_1518308650","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54158"},{"title":"8.7 Make pie chart for total revenue by store","text":"","dateUpdated":"2018-04-08T20:38:00+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368333_-1378862692","id":"20180408-150210_1264374215","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54159"},{"title":"8.8 Find out the busiest time bucket for each store","text":"","dateUpdated":"2018-04-08T20:38:01+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"store_name","index":0,"aggr":"sum"}],"groups":[{"name":"time_bucket","index":2,"aggr":"sum"}],"values":[{"name":"tran_cnt","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368333_-1378862692","id":"20180408-150739_1194633452","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54160"},{"title":"8.9 Find out the loyal customers for each store","text":"","dateUpdated":"2018-04-08T20:38:03+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":true}},"commonSetting":{},"keys":[{"name":"store_name","index":0,"aggr":"sum"},{"name":"customer_id","index":1,"aggr":"sum"}],"groups":[{"name":"store_name","index":0,"aggr":"sum"}],"values":[{"name":"total_cust_purphase","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368333_-1378862692","id":"20180408-151150_1017974569","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54161"},{"title":"8.10 Find out the star store in terms of max revenue per employee","text":"","dateUpdated":"2018-04-08T20:38:04+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"store_name","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"revenue_per_employee_within_period","index":3,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368333_-1378862692","id":"20180408-152850_1865669435","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54162"},{"text":"%md\n### 9. Data Analysis - Store Review Centric","dateUpdated":"2018-04-08T20:29:28+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368333_-1378862692","id":"20180408-154433_894576320","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54163"},{"title":"9.1 Find out conflict transaction to review mapping","text":"","dateUpdated":"2018-04-08T20:38:10+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368333_-1378862692","id":"20180408-154431_1095700753","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54164"},{"title":"9.2 Find out the review coverage by customers","text":"","dateUpdated":"2018-04-08T20:38:06+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[],"groups":[],"values":[{"name":"total_review_missed","index":1,"aggr":"sum"},{"name":"total_review_exist","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368333_-1378862692","id":"20180408-154059_66412743","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54165"},{"title":"9.3 - 9.4 Find out customer/transaction distribution of review score","text":"","dateUpdated":"2018-04-08T20:38:07+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"review_score","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"num_customer","index":1,"aggr":"sum"},{"name":"num_reviews","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368334_-1377708445","id":"20180408-162918_5786207","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54166"},{"title":"9.5 Does customer give best review always visit the same store?","text":"","dateUpdated":"2018-04-08T20:38:13+0000","config":{"editorSetting":{"language":"scala"},"colWidth":6,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368334_-1377708445","id":"20180408-163938_1006331366","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54167"},{"text":"%spark.sql\n","dateUpdated":"2018-04-08T20:29:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523219368334_-1377708445","id":"20180408-163618_1060017969","dateCreated":"2018-04-08T20:29:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54168"}],"name":"Case Study - Shopping Analysis Blank","id":"2DB8GYG4Y","angularObjects":{"2DAAY2J3U:shared_process":[],"2DAEXDE71:shared_process":[],"2DC54DWR5:shared_process":[],"2DAZ2S9RS:shared_process":[],"2DAUQ8PNB:shared_process":[],"2DBG5QCX6:shared_process":[],"2DBCVTXWP:shared_process":[],"2D9YHCFVS:shared_process":[],"2DBKJ6H7W:shared_process":[],"2D9JCJB8X:shared_process":[],"2DAEB27NT:shared_process":[],"2DDGG5FGK:shared_process":[],"2D9RXPD3R:shared_process":[],"2DAQ7W4T1:shared_process":[],"2DC7SR57K:shared_process":[],"2D9MT6KMJ:shared_process":[],"2DABFJT4E:shared_process":[],"2DCSQCEC4:shared_process":[],"2DDFUKK1D:shared_process":[]},"config":{"looknfeel":"simple","personalizedMode":"false"},"info":{}}