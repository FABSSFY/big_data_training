{"paragraphs":[{"text":"%md\n# Creating DataSets","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243347_1740810411","id":"20160617-201427_857258739","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Creating DataSets</h1>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1890"},{"text":"case class Person(\n    name:String,\n    sex:String,\n    age:Int)\n{\n}","dateUpdated":"2017-01-31T22:41:24-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243349_1738501918","id":"20160617-200218_1910498306","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class Person\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1891","dateFinished":"2017-01-31T22:41:34-0800","dateStarted":"2017-01-31T22:41:24-0800","focus":true},{"text":"val persons = Seq(\n        Person(\"Alice\", \"female\", 32), \n        Person(\"Bob\", \"male\", 24),\n        Person(\"Christine\", \"female\", 42), \n        Person(\"Dale\", \"male\", 19),\n        Person(\"Eve\", \"female\", 33)\n    ).toDS","dateUpdated":"2017-01-31T22:41:37-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243349_1738501918","id":"20160617-200626_1254551091","result":{"code":"SUCCESS","type":"TEXT","msg":"\npersons: org.apache.spark.sql.Dataset[Person] = [name: string, sex: string ... 1 more field]\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1892","focus":true,"dateFinished":"2017-01-31T22:41:40-0800","dateStarted":"2017-01-31T22:41:37-0800"},{"text":"persons.collect().foreach(println)","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243349_1738501918","id":"20170105-002313_1230126684","result":{"code":"SUCCESS","type":"TEXT","msg":"Person(Alice,female,32)\nPerson(Bob,male,24)\nPerson(Christine,female,42)\nPerson(Dale,male,19)\nPerson(Eve,female,33)\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1893"},{"text":"%md\n## Inspect Schema","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243349_1738501918","id":"20160617-205347_1951340760","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Inspect Schema</h2>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1894"},{"text":"persons.schema","dateUpdated":"2017-01-31T22:42:11-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243349_1738501918","id":"20160617-201326_798645553","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres3: org.apache.spark.sql.types.StructType = StructType(StructField(name,StringType,true), StructField(sex,StringType,true), StructField(age,IntegerType,false))\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1895","dateFinished":"2017-01-31T22:42:11-0800","dateStarted":"2017-01-31T22:42:11-0800","focus":true},{"text":"persons.printSchema()","dateUpdated":"2017-01-31T22:42:18-0800","config":{"enabled":true,"graph":{"mode":"table","height":124.60000610351562,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243350_1739656165","id":"20170105-010005_1268070331","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- name: string (nullable = true)\n |-- sex: string (nullable = true)\n |-- age: integer (nullable = false)\n\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1896","dateFinished":"2017-01-31T22:42:18-0800","dateStarted":"2017-01-31T22:42:18-0800","focus":true},{"text":"%md\n# Loading Data","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243350_1739656165","id":"20170105-010041_2117356113","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Loading Data</h1>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1897"},{"text":"import org.apache.spark.sql.types.IntegerType\nval persons = spark.read.json(\"file:///home/cloudera/Training/data/persons.json\").withColumn(\"age\", $\"age\".cast(IntegerType)).as[Person]","dateUpdated":"2017-01-31T22:45:57-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243350_1739656165","id":"20170105-010057_986098899","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.types.IntegerType\n\npersons: org.apache.spark.sql.Dataset[Person] = [age: int, height: bigint ... 2 more fields]\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1898","dateFinished":"2017-01-31T22:45:58-0800","dateStarted":"2017-01-31T22:45:57-0800","focus":true},{"text":"%md\n## Note Schema vs Class Definition","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243350_1739656165","id":"20170105-010721_139087314","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Note Schema vs Class Definition</h2>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1899"},{"text":"persons.printSchema()","dateUpdated":"2017-01-31T22:44:10-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243350_1739656165","id":"20170105-010659_1991798171","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- age: integer (nullable = true)\n |-- height: long (nullable = true)\n |-- name: string (nullable = true)\n |-- sex: string (nullable = true)\n\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1900","dateFinished":"2017-01-31T22:44:10-0800","dateStarted":"2017-01-31T22:44:10-0800","focus":true},{"text":"%md\n# Pretty Printing","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243351_1739271416","id":"20160618-054348_706632489","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Pretty Printing</h1>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1901"},{"text":"z.show(persons)","dateUpdated":"2017-01-31T22:44:33-0800","config":{"enabled":true,"graph":{"mode":"table","height":204,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243351_1739271416","id":"20160618-054337_2135335309","result":{"code":"SUCCESS","type":"TABLE","msg":"age\theight\tname\tsex\n14\t156\tAlice\tfemale\n21\t181\tBob\tmale\n27\t176\tCharlie\tmale\n24\t167\tEve\tfemale\n19\t172\tFrances\tfemale\n31\t191\tGeorge\tmale\n","comment":"","msgTable":[[{"key":"height","value":"14"},{"key":"height","value":"156"},{"key":"height","value":"Alice"},{"key":"height","value":"female"}],[{"key":"name","value":"21"},{"key":"name","value":"181"},{"key":"name","value":"Bob"},{"key":"name","value":"male"}],[{"key":"sex","value":"27"},{"key":"sex","value":"176"},{"key":"sex","value":"Charlie"},{"key":"sex","value":"male"}],[{"value":"24"},{"value":"167"},{"value":"Eve"},{"value":"female"}],[{"value":"19"},{"value":"172"},{"value":"Frances"},{"value":"female"}],[{"value":"31"},{"value":"191"},{"value":"George"},{"value":"male"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"height","index":1,"aggr":"sum"},{"name":"name","index":2,"aggr":"sum"},{"name":"sex","index":3,"aggr":"sum"}],"rows":[["14","156","Alice","female"],["21","181","Bob","male"],["27","176","Charlie","male"],["24","167","Eve","female"],["19","172","Frances","female"],["31","191","George","male"]]},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1903","dateFinished":"2017-01-31T22:44:34-0800","dateStarted":"2017-01-31T22:44:33-0800","focus":true},{"text":"%md\n## Use DataFrame-Like API","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243352_1737347671","id":"20160617-205415_2045240993","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Use DataFrame-Like API</h2>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1904"},{"text":"val result = persons.select($\"name\".as[String], $\"age\".as[String])\nz.show(result)","dateUpdated":"2017-01-31T22:45:22-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243352_1737347671","id":"20160618-055305_406692908","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tage\nAlice\t14\nBob\t21\nCharlie\t27\nEve\t24\nFrances\t19\nGeorge\t31\n","comment":"","msgTable":[[{"key":"age","value":"Alice"},{"key":"age","value":"14"}],[{"value":"Bob"},{"value":"21"}],[{"value":"Charlie"},{"value":"27"}],[{"value":"Eve"},{"value":"24"}],[{"value":"Frances"},{"value":"19"}],[{"value":"George"},{"value":"31"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"age","index":1,"aggr":"sum"}],"rows":[["Alice","14"],["Bob","21"],["Charlie","27"],["Eve","24"],["Frances","19"],["George","31"]]},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1905","dateFinished":"2017-01-31T22:45:23-0800","dateStarted":"2017-01-31T22:45:23-0800","focus":true},{"text":"%md\n## Comapre Dataset Types\n\nInput data type is \"Person\", while the result of the select operation is a tuple","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243353_1736962922","id":"20170105-002950_381594314","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Comapre Dataset Types</h2>\n<p>Input data type is &ldquo;Person&rdquo;, while the result of the select operation is a tuple</p>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1906"},{"text":"persons","dateUpdated":"2017-01-31T22:45:31-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243353_1736962922","id":"20170105-003038_78931382","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres14: org.apache.spark.sql.Dataset[Person] = [age: int, height: bigint ... 2 more fields]\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1907","dateFinished":"2017-01-31T22:45:32-0800","dateStarted":"2017-01-31T22:45:31-0800","focus":true},{"text":"result","dateUpdated":"2017-01-31T22:45:35-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243353_1736962922","id":"20170105-003042_32233686","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres16: org.apache.spark.sql.Dataset[(String, String)] = [name: string, age: int]\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1908","dateFinished":"2017-01-31T22:45:35-0800","dateStarted":"2017-01-31T22:45:35-0800","focus":true},{"text":"%md\n## Dataset Joining\n\nDatasets  also support join operations, the result is a tuple.","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243353_1736962922","id":"20160618-064756_323624134","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Dataset Joining</h2>\n<p>Datasets  also support join operations, the result is a tuple.</p>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1909"},{"text":"case class PersonAddress (\n    name:String,\n    city:String\n) { }\n\nval addresses = spark.read.json(\"file:///home/cloudera/Training/data/addresses.json\").as[PersonAddress]","dateUpdated":"2017-01-31T22:46:35-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243353_1736962922","id":"20160618-064806_552944470","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class PersonAddress\n\naddresses: org.apache.spark.sql.Dataset[PersonAddress] = [city: string, name: string]\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1910","dateFinished":"2017-01-31T22:46:36-0800","dateStarted":"2017-01-31T22:46:36-0800","focus":true},{"text":"val result = persons.as(\"person\").joinWith(addresses.as(\"address\"), $\"person.name\" === $\"address.name\")\nz.show(result)","dateUpdated":"2017-01-31T22:46:44-0800","config":{"enabled":true,"graph":{"mode":"table","height":124,"optionOpen":false,"keys":[{"name":"_1","index":0,"aggr":"sum"}],"values":[{"name":"_2","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"_1","index":0,"aggr":"sum"},"yAxis":{"name":"_2","index":1,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243354_1738117169","id":"20160618-065315_531175389","result":{"code":"SUCCESS","type":"TABLE","msg":"_1\t_2\n[14,156,Alice,female]\t[Hamburg,Alice]\n[21,181,Bob,male]\t[Frankfurt,Bob]\n","comment":"","msgTable":[[{"key":"_2","value":"[14,156,Alice,female]"},{"key":"_2","value":"[Hamburg,Alice]"}],[{"value":"[21,181,Bob,male]"},{"value":"[Frankfurt,Bob]"}]],"columnNames":[{"name":"_1","index":0,"aggr":"sum"},{"name":"_2","index":1,"aggr":"sum"}],"rows":[["[14,156,Alice,female]","[Hamburg,Alice]"],["[21,181,Bob,male]","[Frankfurt,Bob]"]]},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1911","dateFinished":"2017-01-31T22:46:45-0800","dateStarted":"2017-01-31T22:46:44-0800","focus":true},{"text":"result","dateUpdated":"2017-01-31T22:47:03-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243354_1738117169","id":"20170105-003325_556063070","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres23: org.apache.spark.sql.Dataset[(Person, PersonAddress)] = [_1: struct<age: int, height: bigint ... 2 more fields>, _2: struct<city: string, name: string>]\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1912","dateFinished":"2017-01-31T22:47:03-0800","dateStarted":"2017-01-31T22:47:03-0800","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931634676_-44320505","id":"20170131-224714_1038353131","dateCreated":"2017-01-31T22:47:14-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5464","text":"result.printSchema","dateUpdated":"2017-01-31T22:47:23-0800","dateFinished":"2017-01-31T22:47:23-0800","dateStarted":"2017-01-31T22:47:23-0800","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- _1: struct (nullable = false)\n |    |-- age: integer (nullable = true)\n |    |-- height: long (nullable = true)\n |    |-- name: string (nullable = true)\n |    |-- sex: string (nullable = true)\n |-- _2: struct (nullable = false)\n |    |-- city: string (nullable = true)\n |    |-- name: string (nullable = true)\n\n"}},{"text":"%md\n## DataFrame like Joining\n\nYou can also use traditional DataFrame join methods, these will return a DataFrame instead of a Dataset","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243354_1738117169","id":"20170105-003438_1163697573","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>DataFrame like Joining</h2>\n<p>You can also use traditional DataFrame join methods, these will return a DataFrame instead of a Dataset</p>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1913"},{"text":"val result = persons.as(\"person\").join(addresses.as(\"address\"), $\"person.name\" === $\"address.name\")\nz.show(result)","dateUpdated":"2017-01-31T22:47:53-0800","config":{"enabled":true,"graph":{"mode":"table","height":129,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243355_1737732420","id":"20170105-003456_603691475","result":{"code":"SUCCESS","type":"TABLE","msg":"age\theight\tname\tsex\tcity\tname\n14\t156\tAlice\tfemale\tHamburg\tAlice\n21\t181\tBob\tmale\tFrankfurt\tBob\n","comment":"","msgTable":[[{"key":"height","value":"14"},{"key":"height","value":"156"},{"key":"height","value":"Alice"},{"key":"height","value":"female"},{"key":"height","value":"Hamburg"},{"key":"height","value":"Alice"}],[{"key":"name","value":"21"},{"key":"name","value":"181"},{"key":"name","value":"Bob"},{"key":"name","value":"male"},{"key":"name","value":"Frankfurt"},{"key":"name","value":"Bob"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"height","index":1,"aggr":"sum"},{"name":"name","index":2,"aggr":"sum"},{"name":"sex","index":3,"aggr":"sum"},{"name":"city","index":4,"aggr":"sum"},{"name":"name","index":5,"aggr":"sum"}],"rows":[["14","156","Alice","female","Hamburg","Alice"],["21","181","Bob","male","Frankfurt","Bob"]]},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1914","dateFinished":"2017-01-31T22:47:54-0800","dateStarted":"2017-01-31T22:47:53-0800","focus":true},{"text":"result.printSchema","dateUpdated":"2017-01-31T22:48:01-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243355_1737732420","id":"20170105-003538_2088315656","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- age: integer (nullable = true)\n |-- height: long (nullable = true)\n |-- name: string (nullable = true)\n |-- sex: string (nullable = true)\n |-- city: string (nullable = true)\n |-- name: string (nullable = true)\n\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1915","dateFinished":"2017-01-31T22:48:01-0800","dateStarted":"2017-01-31T22:48:01-0800","focus":true},{"text":"%md\n## Dataset Grouping\n\nAlso grouping operations are supported, returning the special type \"GroupedData\".","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243356_1735808676","id":"20160618-060107_408877976","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Dataset Grouping</h2>\n<p>Also grouping operations are supported, returning the special type &ldquo;GroupedData&rdquo;.</p>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1916"},{"text":"persons.groupByKey(_.sex)","dateUpdated":"2017-01-31T22:48:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243356_1735808676","id":"20170105-011441_1643155245","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres31: org.apache.spark.sql.KeyValueGroupedDataset[String,Person] = org.apache.spark.sql.KeyValueGroupedDataset@36777e4\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1917","dateFinished":"2017-01-31T22:48:14-0800","dateStarted":"2017-01-31T22:48:14-0800","focus":true},{"text":"val result = persons.groupByKey(_.sex).agg(sum($\"age\").as(\"sum_age\").as[Long])\nz.show(result)","dateUpdated":"2017-01-31T22:50:08-0800","config":{"enabled":true,"graph":{"mode":"table","height":159,"optionOpen":false,"keys":[{"name":"value","index":0,"aggr":"sum"}],"values":[{"name":"sum_age","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"value","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243356_1735808676","id":"20160617-205426_874417461","result":{"code":"SUCCESS","type":"TABLE","msg":"value\tsum_age\nfemale\t57\nmale\t79\n","comment":"","msgTable":[[{"key":"sum_age","value":"female"},{"key":"sum_age","value":"57"}],[{"value":"male"},{"value":"79"}]],"columnNames":[{"name":"value","index":0,"aggr":"sum"},{"name":"sum_age","index":1,"aggr":"sum"}],"rows":[["female","57"],["male","79"]]},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1918","dateFinished":"2017-01-31T22:50:10-0800","dateStarted":"2017-01-31T22:50:08-0800","focus":true},{"text":"result","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243356_1735808676","id":"20170105-003813_1445330503","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres35: org.apache.spark.sql.Dataset[(String, Long)] = [value: string, sum_age: bigint]\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1919"},{"text":"%md\n## DataFrame groupBy","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243357_1735423927","id":"20170105-003951_1649173549","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>DataFrame groupBy</h2>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1920"},{"text":"val result = persons.groupBy($\"sex\").agg(sum($\"age\").as(\"sum_age\"))\nz.show(result)","dateUpdated":"2017-01-31T22:50:30-0800","config":{"enabled":true,"graph":{"mode":"table","height":134,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243357_1735423927","id":"20170105-004005_1889169884","result":{"code":"SUCCESS","type":"TABLE","msg":"sex\tsum_age\nfemale\t57\nmale\t79\n","comment":"","msgTable":[[{"key":"sum_age","value":"female"},{"key":"sum_age","value":"57"}],[{"value":"male"},{"value":"79"}]],"columnNames":[{"name":"sex","index":0,"aggr":"sum"},{"name":"sum_age","index":1,"aggr":"sum"}],"rows":[["female","57"],["male","79"]]},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1921","dateFinished":"2017-01-31T22:50:31-0800","dateStarted":"2017-01-31T22:50:30-0800","focus":true},{"text":"result","dateUpdated":"2017-01-31T22:50:36-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243357_1735423927","id":"20170105-004046_233218812","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres37: org.apache.spark.sql.DataFrame = [sex: string, sum_age: bigint]\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1922","dateFinished":"2017-01-31T22:50:36-0800","dateStarted":"2017-01-31T22:50:36-0800","focus":true},{"text":"%md\n## Use groupByKey with mapGroups","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243358_1736578173","id":"20170105-004009_780928702","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Use groupByKey with mapGroups</h2>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1923"},{"text":"def avg_age(persons:Iterator[Person]) = {\n    val (age,count) = persons\n        .map(p => (p.age,1))\n        .reduce((l,r) => (l._1 + r._1, l._2 + r._2))\n        \n    age.toFloat / count.toFloat\n}\n\nval result = persons\n    .groupByKey(_.sex)\n    .mapGroups { case (key,values) => (key, avg_age(values)) }\n\nz.show(result)","dateUpdated":"2017-01-31T22:52:02-0800","config":{"enabled":true,"graph":{"mode":"table","height":154,"optionOpen":false,"keys":[{"name":"_1","index":0,"aggr":"sum"}],"values":[{"name":"_2","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"_1","index":0,"aggr":"sum"},"yAxis":{"name":"_2","index":1,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243358_1736578173","id":"20160618-060120_1186022942","result":{"code":"SUCCESS","type":"TABLE","msg":"_1\t_2\nfemale\t19.0\nmale\t26.333334\n","comment":"","msgTable":[[{"key":"_2","value":"female"},{"key":"_2","value":"19.0"}],[{"value":"male"},{"value":"26.333334"}]],"columnNames":[{"name":"_1","index":0,"aggr":"sum"},{"name":"_2","index":1,"aggr":"sum"}],"rows":[["female","19.0"],["male","26.333334"]]},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1924","dateFinished":"2017-01-31T22:52:03-0800","dateStarted":"2017-01-31T22:52:02-0800","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931925165_216380550","id":"20170131-225205_2110338895","dateCreated":"2017-01-31T22:52:05-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5605","text":"result","dateUpdated":"2017-01-31T22:52:07-0800","dateFinished":"2017-01-31T22:52:07-0800","dateStarted":"2017-01-31T22:52:07-0800","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres43: org.apache.spark.sql.Dataset[(String, Float)] = [_1: string, _2: float]\n"}},{"text":"%md\n## Convert to RDD\n\nYou can convert a Dataset to a simpler RDD. This will finally drop unused columns.","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243359_1736193424","id":"20160617-201355_1310344176","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Convert to RDD</h2>\n<p>You can convert a Dataset to a simpler RDD. This will finally drop unused columns.</p>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1925"},{"text":"val rdd = persons.rdd\n\nrdd.collect().foreach(println)","dateUpdated":"2017-01-31T22:53:53-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243360_1721957715","id":"20160618-053912_1439030409","result":{"code":"SUCCESS","type":"TEXT","msg":"\nrdd: org.apache.spark.rdd.RDD[Person] = MapPartitionsRDD[62] at rdd at <console>:33\nPerson(Alice,female,14)\nPerson(Bob,male,21)\nPerson(Charlie,male,27)\nPerson(Eve,female,24)\nPerson(Frances,female,19)\nPerson(George,male,31)\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1926","dateFinished":"2017-01-31T22:53:53-0800","dateStarted":"2017-01-31T22:53:53-0800","focus":true},{"text":"%md\n## Convert back RDD to Dataset\n\nNote that the Dataset will not contain the unused column \"height\" any more.","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243360_1721957715","id":"20160618-053953_1578828210","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Convert back RDD to Dataset</h2>\n<p>Note that the Dataset will not contain the unused column &ldquo;height&rdquo; any more.</p>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1927"},{"text":"val ds = rdd.toDS","dateUpdated":"2017-01-31T22:53:57-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243360_1721957715","id":"20160618-053926_647385200","result":{"code":"SUCCESS","type":"TEXT","msg":"\nds: org.apache.spark.sql.Dataset[Person] = [name: string, sex: string ... 1 more field]\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1928","dateFinished":"2017-01-31T22:53:57-0800","dateStarted":"2017-01-31T22:53:57-0800","focus":true},{"text":"%md\n## Write to Parquet\n\n1. Get DataFrame writer\n2. Write Dataset to Parquet\n\nNote that this will also write unused columns!","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243361_1721572966","id":"20160617-201512_1954263996","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Write to Parquet</h2>\n<ol>\n<li>Get DataFrame writer</li>\n<li>Write Dataset to Parquet</li>\n</ol>\n<p>Note that this will also write unused columns!</p>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1929"},{"text":"import org.apache.spark.sql.SaveMode\n\npersons.write.mode(SaveMode.Overwrite).parquet(\"persons.parquet\")","dateUpdated":"2017-01-31T22:54:07-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243361_1721572966","id":"20160617-201343_563402997","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.SaveMode\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1930","dateFinished":"2017-01-31T22:54:07-0800","dateStarted":"2017-01-31T22:54:07-0800","focus":true},{"text":"%md\n## Read from Parquet\n1. Read DataFrame from Parquet\n2. Convert DataFrame to DataSet\n\nSee the unused column \"height\" reappear aggain.","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243361_1721572966","id":"20160617-204919_1431109393","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Read from Parquet</h2>\n<ol>\n<li>Read DataFrame from Parquet</li>\n<li>Convert DataFrame to DataSet</li>\n</ol>\n<p>See the unused column &ldquo;height&rdquo; reappear aggain.</p>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1931"},{"text":"val df = sqlContext.read.parquet(\"persons.parquet\")\nval ds = df.as[Person]\n\nz.show(ds)","dateUpdated":"2017-01-31T22:54:20-0800","config":{"enabled":true,"graph":{"mode":"table","height":244,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243362_1722727213","id":"20160617-204932_794634446","result":{"code":"SUCCESS","type":"TABLE","msg":"age\theight\tname\tsex\n14\t156\tAlice\tfemale\n21\t181\tBob\tmale\n27\t176\tCharlie\tmale\n24\t167\tEve\tfemale\n19\t172\tFrances\tfemale\n31\t191\tGeorge\tmale\n","comment":"","msgTable":[[{"key":"height","value":"14"},{"key":"height","value":"156"},{"key":"height","value":"Alice"},{"key":"height","value":"female"}],[{"key":"name","value":"21"},{"key":"name","value":"181"},{"key":"name","value":"Bob"},{"key":"name","value":"male"}],[{"key":"sex","value":"27"},{"key":"sex","value":"176"},{"key":"sex","value":"Charlie"},{"key":"sex","value":"male"}],[{"value":"24"},{"value":"167"},{"value":"Eve"},{"value":"female"}],[{"value":"19"},{"value":"172"},{"value":"Frances"},{"value":"female"}],[{"value":"31"},{"value":"191"},{"value":"George"},{"value":"male"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"height","index":1,"aggr":"sum"},{"name":"name","index":2,"aggr":"sum"},{"name":"sex","index":3,"aggr":"sum"}],"rows":[["14","156","Alice","female"],["21","181","Bob","male"],["27","176","Charlie","male"],["24","167","Eve","female"],["19","172","Frances","female"],["31","191","George","male"]]},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1932","dateFinished":"2017-01-31T22:54:21-0800","dateStarted":"2017-01-31T22:54:20-0800","focus":true},{"text":"%md\n# Nested Classes","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243362_1722727213","id":"20160617-202215_225550959","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Nested Classes</h1>\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1933"},{"text":"case class Address(\n    city:String,\n    street:String\n)\n    \ncase class Person(\n    name:String,\n    sex:String,\n    addresses:Array[Address]\n)\n","dateUpdated":"2017-01-31T22:54:34-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243363_1722342464","id":"20160618-093335_468111792","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class Address\n\ndefined class Person\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1934","dateFinished":"2017-01-31T22:54:34-0800","dateStarted":"2017-01-31T22:54:34-0800","focus":true},{"text":"val ds = Seq(\n    Person(\"Alice\",\"female\",Array(Address(\"Berlin\",\"Hauptstraße 2\"),Address(\"Stuttgart\",\"Am Anger 13\"))),\n    Person(\"Bob\",\"male\",Array(Address(\"Mainz\",\"Kellergasse 23\")))\n).toDS","dateUpdated":"2017-01-31T22:54:39-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243363_1722342464","id":"20160618-093452_1868521561","result":{"code":"SUCCESS","type":"TEXT","msg":"\nds: org.apache.spark.sql.Dataset[Person] = [name: string, sex: string ... 1 more field]\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1935","dateFinished":"2017-01-31T22:54:39-0800","dateStarted":"2017-01-31T22:54:39-0800","focus":true},{"text":"ds.printSchema()","dateUpdated":"2017-01-31T22:54:41-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243363_1722342464","id":"20160618-093933_727106056","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- name: string (nullable = true)\n |-- sex: string (nullable = true)\n |-- addresses: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- city: string (nullable = true)\n |    |    |-- street: string (nullable = true)\n\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1936","dateFinished":"2017-01-31T22:54:42-0800","dateStarted":"2017-01-31T22:54:41-0800","focus":true},{"text":"import org.apache.spark.sql.SaveMode\n\nds.write.mode(SaveMode.Overwrite).parquet(\"persons2.parquet\")","dateUpdated":"2017-01-31T22:54:45-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243363_1722342464","id":"20160618-093622_1119250452","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.SaveMode\n"},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1937","dateFinished":"2017-01-31T22:54:46-0800","dateStarted":"2017-01-31T22:54:45-0800","focus":true},{"text":"val ds = sqlContext.read.parquet(\"persons2.parquet\").as[Person]\n\nz.show(ds)","dateUpdated":"2017-01-31T22:55:34-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"name","index":0,"aggr":"sum"}],"values":[{"name":"sex","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"name","index":0,"aggr":"sum"},"yAxis":{"name":"sex","index":1,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243364_1720418720","id":"20160618-093745_1829082972","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tsex\taddresses\nAlice\tfemale\tWrappedArray([Berlin,Hauptstraße 2], [Stuttgart,Am Anger 13])\nBob\tmale\tWrappedArray([Mainz,Kellergasse 23])\n","comment":"","msgTable":[[{"key":"sex","value":"Alice"},{"key":"sex","value":"female"},{"key":"sex","value":"WrappedArray([Berlin,Hauptstraße 2], [Stuttgart,Am Anger 13])"}],[{"key":"addresses","value":"Bob"},{"key":"addresses","value":"male"},{"key":"addresses","value":"WrappedArray([Mainz,Kellergasse 23])"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"sex","index":1,"aggr":"sum"},{"name":"addresses","index":2,"aggr":"sum"}],"rows":[["Alice","female","WrappedArray([Berlin,Hauptstraße 2], [Stuttgart,Am Anger 13])"],["Bob","male","WrappedArray([Mainz,Kellergasse 23])"]]},"dateCreated":"2017-01-31T22:40:43-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1938","dateFinished":"2017-01-31T22:55:34-0800","dateStarted":"2017-01-31T22:55:34-0800","focus":true},{"text":"","dateUpdated":"2017-01-31T22:40:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485931243364_1720418720","id":"20160618-093840_324274912","dateCreated":"2017-01-31T22:40:43-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1939"}],"name":"Spark DataSet Snippets","id":"2C7CNUNXV","angularObjects":{"2C73P7NJN:shared_process":[],"2C7KU6EWG:shared_process":[],"2C8H7AG7Q:shared_process":[],"2CANY5QMM:shared_process":[],"2C7YM9SBT:shared_process":[],"2CAHZM5EW:shared_process":[],"2CA194TC4:shared_process":[],"2C85Z5A3J:shared_process":[],"2C77BBC6M:shared_process":[],"2C9T8R64M:shared_process":[],"2C82H3SUX:shared_process":[],"2C7W1UTSM:shared_process":[],"2C99CAHNC:shared_process":[],"2C7VKNJZ3:shared_process":[],"2C7MNAP62:shared_process":[],"2C8SJ4SC1:shared_process":[],"2C8273BS9:shared_process":[],"2CA9V89Q3:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}