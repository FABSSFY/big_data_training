{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485800602326_-590279587","id":"20170130-182322_95660151","dateCreated":"2017-01-30T18:23:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:380","text":"%md\n# Word Count Example\n\nThe most famous example for map/reduce, Hadoop and Spark is to count words. In this example we'll try to count the words from \"Alice in Wonderland\". The text is stored on S3, so we need some boilerplate code to read the data.","dateUpdated":"2017-01-30T18:26:59+0000","dateFinished":"2017-01-30T18:24:28+0000","dateStarted":"2017-01-30T18:24:28+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Word Count Example</h1>\n<p>The most famous example for map/reduce, Hadoop and Spark is to count words. In this example we'll try to count the words from &ldquo;Alice in Wonderland&rdquo;. The text is stored on S3, so we need some boilerplate code to read the data.</p>\n"}},{"text":"import scala.io.Source\nimport com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.services.s3.model.GetObjectRequest\nimport com.amazonaws.auth.DefaultAWSCredentialsProviderChain\n\nval bucketName = \"dimajix-training\"\nval key = \"data/alice/alice-in-wonderland.txt\"\n\nval s3Client = new AmazonS3Client(new DefaultAWSCredentialsProviderChain())\nval s3object = s3Client.getObject(new GetObjectRequest(bucketName, key))\nval source = Source.fromInputStream(s3object.getObjectContent())\n\nfor (line <- source.getLines.take(10)) {\n    println(line)\n}","dateUpdated":"2017-01-30T18:18:15+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485797832687_557505768","id":"20170130-173712_1377286099","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport scala.io.Source\n\nimport com.amazonaws.services.s3.AmazonS3Client\n\nimport com.amazonaws.services.s3.model.GetObjectRequest\n\nimport com.amazonaws.auth.DefaultAWSCredentialsProviderChain\n\nbucketName: String = dimajix-training\n\nkey: String = data/alice/alice-in-wonderland.txt\n\ns3Client: com.amazonaws.services.s3.AmazonS3Client = com.amazonaws.services.s3.AmazonS3Client@417a5e18\n\ns3object: com.amazonaws.services.s3.model.S3Object = S3Object [key=data/alice/alice-in-wonderland.txt,bucket=dimajix-training]\n\nsource: scala.io.BufferedSource = non-empty iterator\n﻿Project Gutenberg's Alice's Adventures in Wonderland, by Lewis Carroll\n\nThis eBook is for the use of anyone anywhere at no cost and with\nalmost no restrictions whatsoever.  You may copy it, give it away or\nre-use it under the terms of the Project Gutenberg License included\nwith this eBook or online at www.gutenberg.org\n\n\nTitle: Alice's Adventures in Wonderland\n\n"},"dateCreated":"2017-01-30T17:37:12+0000","dateStarted":"2017-01-30T18:14:52+0000","dateFinished":"2017-01-30T18:14:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:166"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485800676188_-1066474488","id":"20170130-182436_1257546768","dateCreated":"2017-01-30T18:24:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:466","text":"%md\n## Performing the Word Count\nNow that we've figured out how to read the data, let's try to perform the word count. We'll perform the following steps:\n1. Retrieve all lines from the source\n2. Split all lines into individual words\n3. Remove empty words\n4. Group result by word\n5. Retrieve the size of every group\n6. Sort the result by frequency, in reverse order","dateUpdated":"2017-01-30T18:27:04+0000","dateFinished":"2017-01-30T18:26:37+0000","dateStarted":"2017-01-30T18:26:37+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Performing the Word Count</h2>\n<p>Now that we've figured out how to read the data, let's try to perform the word count. We'll perform the following steps:</p>\n<ol>\n<li>Retrieve all lines from the source</li>\n<li>Split all lines into individual words</li>\n<li>Remove empty words</li>\n<li>Group result by word</li>\n<li>Retrieve the size of every group</li>\n<li>Sort the result by frequency, in reverse order</li>\n</ol>\n"}},{"text":"val s3object = s3Client.getObject(new GetObjectRequest(bucketName, key))\nval source = Source.fromInputStream(s3object.getObjectContent())\nval result = source.getLines.toSeq\n    .flatMap(_.split(\" \"))\n    .filter(_ != \"\")\n    .groupBy(x => x)\n    .mapValues(_.size)\n    .toSeq\n    .sortBy(_._2)\n    .reverse","dateUpdated":"2017-01-30T18:17:57+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485797843156_1781422668","id":"20170130-173723_649915494","result":{"code":"SUCCESS","type":"TEXT","msg":"\ns3object: com.amazonaws.services.s3.model.S3Object = S3Object [key=data/alice/alice-in-wonderland.txt,bucket=dimajix-training]\n\nsource: scala.io.BufferedSource = non-empty iterator\nresult: Seq[(String, Int)] = ArrayBuffer((the,1664), (and,780), (to,773), (a,662), (of,596), (she,484), (said,416), (in,401), (it,356), (was,329), (you,301), (I,260), (as,246), (that,226), (Alice,221), (with,214), (at,211), (her,203), (had,175), (all,168), (be,154), (on,148), (for,146), (or,137), (very,127), (not,122), (this,122), ('I,121), (little,117), (they,109), (but,105), (so,104), (The,100), (out,97), (he,96), (his,93), (about,91), (is,89), (what,86), (up,83), (were,82), (went,79), (one,78), (Project,77), (have,77), (down,77), (Alice,,76), (like,74), (if,73), (no,72), (by,72), (would,68), (when,67), (into,67), (any,67), (could,63), (thought,63), (your,62), (its,60), (do,60), (*,60), (an,56), (Mock,56), (my,55), (Alice.,54), (are,54), (Gutenberg-tm,53), (quite,53), (who,51), (their..."},"dateCreated":"2017-01-30T17:37:23+0000","dateStarted":"2017-01-30T18:17:57+0000","dateFinished":"2017-01-30T18:17:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:167"},{"text":"","dateUpdated":"2017-01-30T18:15:38+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485800127993_605846735","id":"20170130-181527_451771688","dateCreated":"2017-01-30T18:15:27+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:168"}],"name":"Scala Introduction - WordCount S3 - Full","id":"2CA4Y7AM8","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}