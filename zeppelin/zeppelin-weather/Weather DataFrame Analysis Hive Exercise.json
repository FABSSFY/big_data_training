{"paragraphs":[{"text":"%md\n# Weather Data Analytics\nThis notebook performs some basic weather data analytics using the Spark DataFrame interface.","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314501_-692498946","id":"20160612-182259_265217764","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Weather Data Analytics</h1>\n<p>This notebook performs some basic weather data analytics using the Spark DataFrame interface.</p>\n"},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11434"},{"text":"%md\n# Hive Preparations\n\nIn order to ease working with the data, we register all data as Hive tables.","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314501_-692498946","id":"20160612-182259_40944534","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Hive Preparations</h1>\n<p>In order to ease working with the data, we register all data as Hive tables.</p>\n"},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11435"},{"text":"// Common data location - adjust if not correct\nval storageLocation = \"s3://dimajix-training/data/weather\"","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314501_-692498946","id":"20160612-182259_960015898","dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11436","focus":true},{"text":"%sql\ncreate database if not exists training","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314501_-692498946","id":"20160612-182259_942557775","result":{"code":"SUCCESS","type":"TABLE","msg":"result\n","comment":"","msgTable":[],"columnNames":[{"name":"result","index":0,"aggr":"sum"}],"rows":[]},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11437"},{"text":"%md\n## Creating Hive tables for Weather Data\nSince the weather data itself is not a simple CSV format, but something more complex, we chose a two step approach:\n\n1. Create a simple table, where the data files are presented as simple text records. Each line is a full record\n2. Create a VIEW on top of the table, which will extract the desired parameters from the raw data.\n\nSicne we have multiple years, we also partition the raw data table by year.","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314502_-691344699","id":"20160612-182259_1729144153","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Creating Hive tables for Weather Data</h2>\n<p>Since the weather data itself is not a simple CSV format, but something more complex, we chose a two step approach:</p>\n<ol>\n<li>Create a simple table, where the data files are presented as simple text records. Each line is a full record</li>\n<li>Create a VIEW on top of the table, which will extract the desired parameters from the raw data.</li>\n</ol>\n<p>Sicne we have multiple years, we also partition the raw data table by year.</p>\n"},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11438"},{"text":"%sql\ncreate external table training.weather_raw (\n    data string\n)\npartitioned by(year string) \nstored as textfile","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314502_-691344699","id":"20160612-182259_1977068267","result":{"code":"SUCCESS","type":"TABLE","msg":"result\n","comment":"","msgTable":[],"columnNames":[{"name":"result","index":0,"aggr":"sum"}],"rows":[]},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11439"},{"text":"%sql\nCREATE VIEW training.weather AS\nSELECT \n    year,\n    SUBSTR(`data`,5,6) AS `usaf`,\n    SUBSTR(`data`,11,5) AS `wban`, \n    SUBSTR(`data`,16,8) AS `date`, \n    SUBSTR(`data`,24,4) AS `time`,\n    SUBSTR(`data`,42,5) AS report_type,\n    SUBSTR(`data`,61,3) AS wind_direction, \n    SUBSTR(`data`,64,1) AS wind_direction_qual, \n    SUBSTR(`data`,65,1) AS wind_observation, \n    CAST(SUBSTR(`data`,66,4) AS FLOAT)/10 AS wind_speed,\n    SUBSTR(`data`,70,1) AS wind_speed_qual,\n    CAST(SUBSTR(`data`,88,5) AS FLOAT)/10 AS air_temperature, \n    SUBSTR(`data`,93,1) AS air_temperature_qual \nFROM training.weather_raw\n","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"result","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"result","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314502_-691344699","id":"20160612-182259_571893438","result":{"code":"SUCCESS","type":"TABLE","msg":"result\n","comment":"","msgTable":[],"columnNames":[{"name":"result","index":0,"aggr":"sum"}],"rows":[]},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11440"},{"text":"%md\n## Adding Data Partitions\n\nNow we need to add all data as partitions. Since this would be somewhat tedious to do it over and over again for every partition, we remember that we know how to program and let Scala do the work for us.","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314502_-691344699","id":"20160612-182259_1823692141","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Adding Data Partitions</h2>\n<p>Now we need to add all data as partitions. Since this would be somewhat tedious to do it over and over again for every partition, we remember that we know how to program and let Scala do the work for us.</p>\n"},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11441"},{"text":"// Add all partitions\n(2003 to 2014) map {i => sqlContext.sql(s\"alter table training.weather_raw add partition(year='${i}') location '${storageLocation}/${i}'\") }","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314502_-691344699","id":"20160612-182259_1907203803","dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11442","focus":true},{"text":"%sql\nselect * from training.weather limit 10","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314502_-691344699","id":"20160612-182259_1033401899","result":{"code":"SUCCESS","type":"TABLE","msg":"year\tusaf\twban\tdate\ttime\treport_type\twind_direction\twind_direction_qual\twind_observation\twind_speed\twind_speed_qual\tair_temperature\tair_temperature_qual\n2013\t010060\t99999\t20130101\t0000\tFM-12\t120\t1\tN\t16.0\t1\t-1.6\t1\n2013\t010060\t99999\t20130101\t0100\tFM-12\t110\t1\tN\t15.0\t1\t-1.5\t1\n2013\t010060\t99999\t20130101\t0200\tFM-12\t120\t1\tN\t15.0\t1\t-1.4\t1\n2013\t010060\t99999\t20130101\t0300\tFM-12\t120\t1\tN\t14.0\t1\t-1.3\t1\n2013\t010060\t99999\t20130101\t0400\tFM-12\t120\t1\tN\t13.0\t1\t-1.5\t1\n2013\t010060\t99999\t20130101\t0500\tFM-12\t110\t1\tN\t12.0\t1\t-1.4\t1\n2013\t010060\t99999\t20130101\t0600\tFM-12\t110\t1\tN\t12.0\t1\t-1.3\t1\n2013\t010060\t99999\t20130101\t0700\tFM-12\t110\t1\tN\t11.0\t1\t-1.3\t1\n2013\t010060\t99999\t20130101\t0800\tFM-12\t110\t1\tN\t12.0\t1\t-1.4\t1\n2013\t010060\t99999\t20130101\t0900\tFM-12\t110\t1\tN\t12.0\t1\t-1.3\t1\n","comment":"","msgTable":[[{"key":"usaf","value":"2013"},{"key":"usaf","value":"010060"},{"key":"usaf","value":"99999"},{"key":"usaf","value":"20130101"},{"key":"usaf","value":"0000"},{"key":"usaf","value":"FM-12"},{"key":"usaf","value":"120"},{"key":"usaf","value":"1"},{"key":"usaf","value":"N"},{"key":"usaf","value":"16.0"},{"key":"usaf","value":"1"},{"key":"usaf","value":"-1.6"},{"key":"usaf","value":"1"}],[{"key":"wban","value":"2013"},{"key":"wban","value":"010060"},{"key":"wban","value":"99999"},{"key":"wban","value":"20130101"},{"key":"wban","value":"0100"},{"key":"wban","value":"FM-12"},{"key":"wban","value":"110"},{"key":"wban","value":"1"},{"key":"wban","value":"N"},{"key":"wban","value":"15.0"},{"key":"wban","value":"1"},{"key":"wban","value":"-1.5"},{"key":"wban","value":"1"}],[{"key":"date","value":"2013"},{"key":"date","value":"010060"},{"key":"date","value":"99999"},{"key":"date","value":"20130101"},{"key":"date","value":"0200"},{"key":"date","value":"FM-12"},{"key":"date","value":"120"},{"key":"date","value":"1"},{"key":"date","value":"N"},{"key":"date","value":"15.0"},{"key":"date","value":"1"},{"key":"date","value":"-1.4"},{"key":"date","value":"1"}],[{"key":"time","value":"2013"},{"key":"time","value":"010060"},{"key":"time","value":"99999"},{"key":"time","value":"20130101"},{"key":"time","value":"0300"},{"key":"time","value":"FM-12"},{"key":"time","value":"120"},{"key":"time","value":"1"},{"key":"time","value":"N"},{"key":"time","value":"14.0"},{"key":"time","value":"1"},{"key":"time","value":"-1.3"},{"key":"time","value":"1"}],[{"key":"report_type","value":"2013"},{"key":"report_type","value":"010060"},{"key":"report_type","value":"99999"},{"key":"report_type","value":"20130101"},{"key":"report_type","value":"0400"},{"key":"report_type","value":"FM-12"},{"key":"report_type","value":"120"},{"key":"report_type","value":"1"},{"key":"report_type","value":"N"},{"key":"report_type","value":"13.0"},{"key":"report_type","value":"1"},{"key":"report_type","value":"-1.5"},{"key":"report_type","value":"1"}],[{"key":"wind_direction","value":"2013"},{"key":"wind_direction","value":"010060"},{"key":"wind_direction","value":"99999"},{"key":"wind_direction","value":"20130101"},{"key":"wind_direction","value":"0500"},{"key":"wind_direction","value":"FM-12"},{"key":"wind_direction","value":"110"},{"key":"wind_direction","value":"1"},{"key":"wind_direction","value":"N"},{"key":"wind_direction","value":"12.0"},{"key":"wind_direction","value":"1"},{"key":"wind_direction","value":"-1.4"},{"key":"wind_direction","value":"1"}],[{"key":"wind_direction_qual","value":"2013"},{"key":"wind_direction_qual","value":"010060"},{"key":"wind_direction_qual","value":"99999"},{"key":"wind_direction_qual","value":"20130101"},{"key":"wind_direction_qual","value":"0600"},{"key":"wind_direction_qual","value":"FM-12"},{"key":"wind_direction_qual","value":"110"},{"key":"wind_direction_qual","value":"1"},{"key":"wind_direction_qual","value":"N"},{"key":"wind_direction_qual","value":"12.0"},{"key":"wind_direction_qual","value":"1"},{"key":"wind_direction_qual","value":"-1.3"},{"key":"wind_direction_qual","value":"1"}],[{"key":"wind_observation","value":"2013"},{"key":"wind_observation","value":"010060"},{"key":"wind_observation","value":"99999"},{"key":"wind_observation","value":"20130101"},{"key":"wind_observation","value":"0700"},{"key":"wind_observation","value":"FM-12"},{"key":"wind_observation","value":"110"},{"key":"wind_observation","value":"1"},{"key":"wind_observation","value":"N"},{"key":"wind_observation","value":"11.0"},{"key":"wind_observation","value":"1"},{"key":"wind_observation","value":"-1.3"},{"key":"wind_observation","value":"1"}],[{"key":"wind_speed","value":"2013"},{"key":"wind_speed","value":"010060"},{"key":"wind_speed","value":"99999"},{"key":"wind_speed","value":"20130101"},{"key":"wind_speed","value":"0800"},{"key":"wind_speed","value":"FM-12"},{"key":"wind_speed","value":"110"},{"key":"wind_speed","value":"1"},{"key":"wind_speed","value":"N"},{"key":"wind_speed","value":"12.0"},{"key":"wind_speed","value":"1"},{"key":"wind_speed","value":"-1.4"},{"key":"wind_speed","value":"1"}],[{"key":"wind_speed_qual","value":"2013"},{"key":"wind_speed_qual","value":"010060"},{"key":"wind_speed_qual","value":"99999"},{"key":"wind_speed_qual","value":"20130101"},{"key":"wind_speed_qual","value":"0900"},{"key":"wind_speed_qual","value":"FM-12"},{"key":"wind_speed_qual","value":"110"},{"key":"wind_speed_qual","value":"1"},{"key":"wind_speed_qual","value":"N"},{"key":"wind_speed_qual","value":"12.0"},{"key":"wind_speed_qual","value":"1"},{"key":"wind_speed_qual","value":"-1.3"},{"key":"wind_speed_qual","value":"1"}]],"columnNames":[{"name":"year","index":0,"aggr":"sum"},{"name":"usaf","index":1,"aggr":"sum"},{"name":"wban","index":2,"aggr":"sum"},{"name":"date","index":3,"aggr":"sum"},{"name":"time","index":4,"aggr":"sum"},{"name":"report_type","index":5,"aggr":"sum"},{"name":"wind_direction","index":6,"aggr":"sum"},{"name":"wind_direction_qual","index":7,"aggr":"sum"},{"name":"wind_observation","index":8,"aggr":"sum"},{"name":"wind_speed","index":9,"aggr":"sum"},{"name":"wind_speed_qual","index":10,"aggr":"sum"},{"name":"air_temperature","index":11,"aggr":"sum"},{"name":"air_temperature_qual","index":12,"aggr":"sum"}],"rows":[["2013","010060","99999","20130101","0000","FM-12","120","1","N","16.0","1","-1.6","1"],["2013","010060","99999","20130101","0100","FM-12","110","1","N","15.0","1","-1.5","1"],["2013","010060","99999","20130101","0200","FM-12","120","1","N","15.0","1","-1.4","1"],["2013","010060","99999","20130101","0300","FM-12","120","1","N","14.0","1","-1.3","1"],["2013","010060","99999","20130101","0400","FM-12","120","1","N","13.0","1","-1.5","1"],["2013","010060","99999","20130101","0500","FM-12","110","1","N","12.0","1","-1.4","1"],["2013","010060","99999","20130101","0600","FM-12","110","1","N","12.0","1","-1.3","1"],["2013","010060","99999","20130101","0700","FM-12","110","1","N","11.0","1","-1.3","1"],["2013","010060","99999","20130101","0800","FM-12","110","1","N","12.0","1","-1.4","1"],["2013","010060","99999","20130101","0900","FM-12","110","1","N","12.0","1","-1.3","1"]]},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11443"},{"text":"%md\n## Creating Table for Station Metadata\n\nFortunately station metadata is stored as CSV, so we can directly create a table.","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314503_-691729448","id":"20160612-182259_1685463204","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Creating Table for Station Metadata</h2>\n<p>Fortunately station metadata is stored as CSV, so we can directly create a table.</p>\n"},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11444"},{"text":"%sql\nCREATE EXTERNAL TABLE training.stations(\n    usaf STRING,\n    wban STRING,\n    name STRING,\n    country STRING,\n    state STRING,\n    icao STRING,\n    latitude FLOAT,\n    longitude FLOAT,\n    elevation FLOAT,\n    date_begin STRING,\n    date_end STRING) \nROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'\nWITH SERDEPROPERTIES (\n   \"separatorChar\" = \",\",\n   \"quoteChar\"     = \"\\\"\",\n   \"escapeChar\"    = \"\\\\\"\n)\nSTORED AS TEXTFILE\nLOCATION 's3://dimajix-training/data/weather/isd-history'","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"tableHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"result","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"result","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314503_-691729448","id":"20160612-182259_123282051","result":{"code":"SUCCESS","type":"TABLE","msg":"result\n","comment":"","msgTable":[],"columnNames":[{"name":"result","index":0,"aggr":"sum"}],"rows":[]},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11445"},{"text":"%sql\nselect * from training.stations limit 10","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314503_-691729448","id":"20160612-182259_1827195449","result":{"code":"SUCCESS","type":"TABLE","msg":"usaf\twban\tname\tcountry\tstate\ticao\tlatitude\tlongitude\televation\tdate_begin\tdate_end\nUSAF\tWBAN\tSTATION NAME\tCTRY\tSTATE\tICAO\tLAT\tLON\tELEV(M)\tBEGIN\tEND\n007005\t99999\tCWOS 07005\t\t\t\t\t\t\t20120127\t20120127\n007011\t99999\tCWOS 07011\t\t\t\t\t\t\t20111025\t20121129\n007018\t99999\tWXPOD 7018\t\t\t\t+00.000\t+000.000\t+7018.0\t20110309\t20130730\n007025\t99999\tCWOS 07025\t\t\t\t\t\t\t20120127\t20120127\n007026\t99999\tWXPOD 7026\tAF\t\t\t+00.000\t+000.000\t+7026.0\t20120713\t20141120\n007034\t99999\tCWOS 07034\t\t\t\t\t\t\t20121024\t20121106\n007037\t99999\tCWOS 07037\t\t\t\t\t\t\t20111202\t20121125\n007044\t99999\tCWOS 07044\t\t\t\t\t\t\t20120127\t20120127\n007047\t99999\tCWOS 07047\t\t\t\t\t\t\t20120613\t20120717\n","comment":"","msgTable":[[{"key":"wban","value":"USAF"},{"key":"wban","value":"WBAN"},{"key":"wban","value":"STATION NAME"},{"key":"wban","value":"CTRY"},{"key":"wban","value":"STATE"},{"key":"wban","value":"ICAO"},{"key":"wban","value":"LAT"},{"key":"wban","value":"LON"},{"key":"wban","value":"ELEV(M)"},{"key":"wban","value":"BEGIN"},{"key":"wban","value":"END"}],[{"key":"name","value":"007005"},{"key":"name","value":"99999"},{"key":"name","value":"CWOS 07005"},{"key":"name","value":""},{"key":"name","value":""},{"key":"name","value":""},{"key":"name","value":""},{"key":"name","value":""},{"key":"name","value":""},{"key":"name","value":"20120127"},{"key":"name","value":"20120127"}],[{"key":"country","value":"007011"},{"key":"country","value":"99999"},{"key":"country","value":"CWOS 07011"},{"key":"country","value":""},{"key":"country","value":""},{"key":"country","value":""},{"key":"country","value":""},{"key":"country","value":""},{"key":"country","value":""},{"key":"country","value":"20111025"},{"key":"country","value":"20121129"}],[{"key":"state","value":"007018"},{"key":"state","value":"99999"},{"key":"state","value":"WXPOD 7018"},{"key":"state","value":""},{"key":"state","value":""},{"key":"state","value":""},{"key":"state","value":"+00.000"},{"key":"state","value":"+000.000"},{"key":"state","value":"+7018.0"},{"key":"state","value":"20110309"},{"key":"state","value":"20130730"}],[{"key":"icao","value":"007025"},{"key":"icao","value":"99999"},{"key":"icao","value":"CWOS 07025"},{"key":"icao","value":""},{"key":"icao","value":""},{"key":"icao","value":""},{"key":"icao","value":""},{"key":"icao","value":""},{"key":"icao","value":""},{"key":"icao","value":"20120127"},{"key":"icao","value":"20120127"}],[{"key":"latitude","value":"007026"},{"key":"latitude","value":"99999"},{"key":"latitude","value":"WXPOD 7026"},{"key":"latitude","value":"AF"},{"key":"latitude","value":""},{"key":"latitude","value":""},{"key":"latitude","value":"+00.000"},{"key":"latitude","value":"+000.000"},{"key":"latitude","value":"+7026.0"},{"key":"latitude","value":"20120713"},{"key":"latitude","value":"20141120"}],[{"key":"longitude","value":"007034"},{"key":"longitude","value":"99999"},{"key":"longitude","value":"CWOS 07034"},{"key":"longitude","value":""},{"key":"longitude","value":""},{"key":"longitude","value":""},{"key":"longitude","value":""},{"key":"longitude","value":""},{"key":"longitude","value":""},{"key":"longitude","value":"20121024"},{"key":"longitude","value":"20121106"}],[{"key":"elevation","value":"007037"},{"key":"elevation","value":"99999"},{"key":"elevation","value":"CWOS 07037"},{"key":"elevation","value":""},{"key":"elevation","value":""},{"key":"elevation","value":""},{"key":"elevation","value":""},{"key":"elevation","value":""},{"key":"elevation","value":""},{"key":"elevation","value":"20111202"},{"key":"elevation","value":"20121125"}],[{"key":"date_begin","value":"007044"},{"key":"date_begin","value":"99999"},{"key":"date_begin","value":"CWOS 07044"},{"key":"date_begin","value":""},{"key":"date_begin","value":""},{"key":"date_begin","value":""},{"key":"date_begin","value":""},{"key":"date_begin","value":""},{"key":"date_begin","value":""},{"key":"date_begin","value":"20120127"},{"key":"date_begin","value":"20120127"}],[{"key":"date_end","value":"007047"},{"key":"date_end","value":"99999"},{"key":"date_end","value":"CWOS 07047"},{"key":"date_end","value":""},{"key":"date_end","value":""},{"key":"date_end","value":""},{"key":"date_end","value":""},{"key":"date_end","value":""},{"key":"date_end","value":""},{"key":"date_end","value":"20120613"},{"key":"date_end","value":"20120717"}]],"columnNames":[{"name":"usaf","index":0,"aggr":"sum"},{"name":"wban","index":1,"aggr":"sum"},{"name":"name","index":2,"aggr":"sum"},{"name":"country","index":3,"aggr":"sum"},{"name":"state","index":4,"aggr":"sum"},{"name":"icao","index":5,"aggr":"sum"},{"name":"latitude","index":6,"aggr":"sum"},{"name":"longitude","index":7,"aggr":"sum"},{"name":"elevation","index":8,"aggr":"sum"},{"name":"date_begin","index":9,"aggr":"sum"},{"name":"date_end","index":10,"aggr":"sum"}],"rows":[["USAF","WBAN","STATION NAME","CTRY","STATE","ICAO","LAT","LON","ELEV(M)","BEGIN","END"],["007005","99999","CWOS 07005","","","","","","","20120127","20120127"],["007011","99999","CWOS 07011","","","","","","","20111025","20121129"],["007018","99999","WXPOD 7018","","","","+00.000","+000.000","+7018.0","20110309","20130730"],["007025","99999","CWOS 07025","","","","","","","20120127","20120127"],["007026","99999","WXPOD 7026","AF","","","+00.000","+000.000","+7026.0","20120713","20141120"],["007034","99999","CWOS 07034","","","","","","","20121024","20121106"],["007037","99999","CWOS 07037","","","","","","","20111202","20121125"],["007044","99999","CWOS 07044","","","","","","","20120127","20120127"],["007047","99999","CWOS 07047","","","","","","","20120613","20120717"]]},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11446"},{"text":"%md\n# Analytics\n\nNow that we have everything in Hive, we can do the analysis easily.\n\n1. Load Hive tables as DataFrames\n2. Join both DataFrames and station code (wban and usaf)\n3. Extract year from date\n4. Group by country and year\n5. Aggregate minimum/maximum values for wind and temperature, pay attention to quality!\n6. Print the results, such that Zeppelin can make nice graphics :)","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314503_-691729448","id":"20160612-182259_657759243","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Analytics</h1>\n<p>Now that we have everything in Hive, we can do the analysis easily.</p>\n<ol>\n<li>Load Hive tables as DataFrames</li>\n<li>Join both DataFrames and station code (wban and usaf)</li>\n<li>Extract year from date</li>\n<li>Group by country and year</li>\n<li>Aggregate minimum/maximum values for wind and temperature, pay attention to quality!</li>\n<li>Print the results, such that Zeppelin can make nice graphics :)</li>\n</ol>\n"},"dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11447"},{"text":"// YOUR CODE HERE\nval result = ...\n  \nz.show(result)","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"multiBarChart","height":164,"optionOpen":false,"keys":[{"name":"country","index":0,"aggr":"sum"}],"values":[{"name":"min_wind_speed","index":2,"aggr":"min"},{"name":"max_wind_speed","index":3,"aggr":"max"},{"name":"min_temperature","index":4,"aggr":"min"},{"name":"max_temperature","index":5,"aggr":"max"}],"groups":[{"name":"year","index":1,"aggr":"sum"}],"scatter":{"xAxis":{"name":"country","index":0,"aggr":"sum"},"yAxis":{"name":"year","index":1,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314504_-693653192","id":"20160612-182259_1861265992","dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11448"},{"text":"","dateUpdated":"2017-02-28T23:45:14-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488354314504_-693653192","id":"20160612-182259_2050725342","dateCreated":"2017-02-28T23:45:14-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11449"}],"name":"Weather DataFrame Analysis Hive Exercise","id":"2CBW8DMKC","angularObjects":{"2C73P7NJN:shared_process":[],"2C7KU6EWG:shared_process":[],"2C8H7AG7Q:shared_process":[],"2CANY5QMM:shared_process":[],"2C7YM9SBT:shared_process":[],"2CAHZM5EW:shared_process":[],"2CA194TC4:shared_process":[],"2C85Z5A3J:shared_process":[],"2C77BBC6M:shared_process":[],"2C9T8R64M:shared_process":[],"2C82H3SUX:shared_process":[],"2C7W1UTSM:shared_process":[],"2C99CAHNC:shared_process":[],"2C7VKNJZ3:shared_process":[],"2C7MNAP62:shared_process":[],"2C8SJ4SC1:shared_process":[],"2C8273BS9:shared_process":[],"2CA9V89Q3:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}